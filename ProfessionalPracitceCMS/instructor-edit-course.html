<!DOCTYPE html>
<html lang="en" dir="ltr" class="dark-mode">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Luma</title>

    <!-- Prevent the demo from appearing in search engines -->
    <meta name="robots" content="noindex">

    <link href="https://fonts.googleapis.com/css?family=Lato:400,700%7CRoboto:400,500%7CExo+2:600&display=swap"
        rel="stylesheet">

    <!-- Preloader -->
    <link type="text/css" href="public/vendor/spinkit.css" rel="stylesheet">

    <!-- Perfect Scrollbar -->
    <link type="text/css" href="public/vendor/perfect-scrollbar.css" rel="stylesheet">

    <!-- Material Design Icons -->
    <link type="text/css" href="public/css/material-icons.css" rel="stylesheet">

    <!-- Font Awesome Icons -->
    <link type="text/css" href="public/css/fontawesome.css" rel="stylesheet">

    <!-- Preloader -->
    <link type="text/css" href="public/css/preloader.css" rel="stylesheet">

    <!-- App CSS -->
    <link type="text/css" href="public/css/app.css" rel="stylesheet">

    <!-- Dark Mode CSS -->
    <link type="text/css" href="public/css/dark.css" rel="stylesheet">

    <!-- my css styles -->
    <link rel="stylesheet" href="myCss/mine.css">

    <!-- my added bootstrap.css -->
    <link rel="stylesheet" type="text/css" href="myCss/bootstrap.css">
</head>

<body class="layout-app ">

    <!-- Modal -->
    <div class="modal fade" id="myModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <form class="modal-content bg-dark" id="myForm">
                <div class="d-flex justify-content-between w-100 p-3">
                    <!-- Close button at the left end -->
                    <h3 class="modal-title " id="exampleModalLabel">Trainer</h1>
                        <button type="button" class="btn-close btn-close-white " data-bs-dismiss="modal"
                            aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <input type="text" id="UserId" name="UserId" value="-1" hidden>
                    <div class="form-floating mb-3">
                        <input type="text" class="form-control input-text" id="FirstName"
                            placeholder="Enter name" name="FirstName">
                        <label for="FirstName">First Name</label>
                    </div>
                    <div class="form-floating mb-3">
                        <input type="text" class="form-control input-text" id="LastName"
                            placeholder="Enter last name" name="LastName">
                        <label for="LastName">Last Name</label>
                    </div>
                    <div class="form-floating mb-3">
                        <input type="text" class="form-control input-text" id="Tel"
                            placeholder="Enter Tel" name="Tel">
                        <label for="Tel">Tel</label>
                    </div>
                    <div class="form-floating mb-3">
                        <input type="email" class="form-control input-text" id="Email"
                            placeholder="Enter email" name="Email">
                        <label for="Email">Email</label>
                    </div>
                    <div class="form-floating mb-3">
                        <input type="hidden" class="form-control" id="isActive" name="IsActive" value="1">
                    </div>
                    <div class="toggle-icon" id="toggleButton">
                        <div class="label-box">Active</div>
                        <i id="icon" class="fa fa-check"></i>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-primary" id="save">Submit</button>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Preloader -->
    <div class="preloader">
        <div class="sk-chase">
            <div class="sk-chase-dot"></div>
            <div class="sk-chase-dot"></div>
            <div class="sk-chase-dot"></div>
            <div class="sk-chase-dot"></div>
            <div class="sk-chase-dot"></div>
            <div class="sk-chase-dot"></div>
        </div>
    </div>

    <!-- Drawer Layout -->
    <div class="mdk-drawer-layout js-mdk-drawer-layout" data-push data-responsive-width="992px">
        <div class="mdk-drawer-layout__content page-content">
            <!-- Header -->
            <div id="myHeader"></div>
            <!-- // END Header -->

            <!-- Page Content -->
            <div class="page-section border-bottom-2">
                <div class="container">
            
                    <div class="row">
                        <div class="col-md-8">
            
                            <div class="page-separator">
                                <div class="page-separator__text">Basic information</div>
                            </div>
            
                            <label class="form-label">Course title</label>
                            <div class="form-group mb-24pt">
                                <input type="text"
                                       class="form-control form-control-lg"
                                       placeholder="Course title"
                                       value="Angular Fundamentals">
                                <small class="form-text text-muted">Please see our <a href="">course title guideline</a></small>
                            </div>
            
                            <div class="form-group mb-32pt">
                                <label class="form-label">Description</label>
                                <input type="text" class="form-control" id="course Description" placeholder="Course description" value="Hello World! Some initial bold text">
                                <small class="form-text text-muted">Shortly describe this course.</small>
                            </div>
                            
            
                            <div class="page-separator">
                                <div class="page-separator__text">Sections</div>
                            </div>
            
                            <div class="accordion js-accordion accordion--boxed mb-24pt"
                                 id="parent">
                                <div class="accordion__item">
                                    <a href="#"
                                       class="accordion__toggle collapsed"
                                       data-toggle="collapse"
                                       data-target="#course-toc-1"
                                       data-parent="#parent">
                                        <span class="flex">Course Overview</span>
                                        <span class="accordion__toggle-icon material-icons">keyboard_arrow_down</span>
                                    </a>
                                    <div class="accordion__menu collapse"
                                         id="course-toc-1">
                                        <div class="accordion__menu-link">
                                            <i class="material-icons text-70 icon-16pt icon--left">drag_handle</i>
                                            <a class="flex"
                                               href="student-lesson.html">Watch Trailer</a>
                                            <span class="text-muted">1m 10s</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="accordion__item open">
                                    <a href="#"
                                       class="accordion__toggle"
                                       data-toggle="collapse"
                                       data-target="#course-toc-2"
                                       data-parent="#parent">
                                        <span class="flex">Getting Started with Angular</span>
                                        <span class="accordion__toggle-icon material-icons">keyboard_arrow_down</span>
                                    </a>
                                    <div class="accordion__menu collapse show"
                                         id="course-toc-2">
                                        <div class="accordion__menu-link">
                                            <i class="material-icons text-70 icon-16pt icon--left">drag_handle</i>
                                            <a class="flex"
                                               href="student-lesson.html">Introduction</a>
                                            <span class="text-muted">8m 42s</span>
                                        </div>
                                        <div class="accordion__menu-link active">
                                            <i class="material-icons text-70 icon-16pt icon--left">drag_handle</i>
                                            <a class="flex"
                                               href="student-lesson.html">Introduction to TypeScript</a>
                                            <span class="text-muted">50m 13s</span>
                                        </div>
                                        <div class="accordion__menu-link">
                                            <i class="material-icons text-70 icon-16pt icon--left">drag_handle</i>
                                            <a class="flex"
                                               href="student-lesson.html">Comparing Angular to AngularJS</a>
                                            <span class="text-muted">12m 10s</span>
                                        </div>
                                        <div class="accordion__menu-link">
                                            <i class="material-icons text-70 icon-16pt icon--left">drag_handle</i>
                                            <a class="flex"
                                               href="student-take-quiz.html">Quiz: Getting Started With Angular</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="accordion__item">
                                    <a href="#"
                                       class="accordion__toggle collapsed"
                                       data-toggle="collapse"
                                       data-target="#course-toc-3"
                                       data-parent="#parent">
                                        <span class="flex">Creating and Communicating Between Angular Components</span>
                                        <span class="accordion__toggle-icon material-icons">keyboard_arrow_down</span>
                                    </a>
                                    <div class="accordion__menu collapse"
                                         id="course-toc-3">
                                        <div class="accordion__menu-link">
                                            <i class="material-icons text-70 icon-16pt icon--left">drag_handle</i>
                                            <a class="flex"
                                               href="student-lesson.html">Angular Components</a>
                                            <span class="text-muted">04:23</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="accordion__item">
                                    <a href="#"
                                       class="accordion__toggle collapsed"
                                       data-toggle="collapse"
                                       data-target="#course-toc-4"
                                       data-parent="#parent">
                                        <span class="flex">Exploring the Angular Template Syntax</span>
                                        <span class="accordion__toggle-icon material-icons">keyboard_arrow_down</span>
                                    </a>
                                    <div class="accordion__menu collapse"
                                         id="course-toc-4">
                                        <div class="accordion__menu-link">
                                            <i class="material-icons text-70 icon-16pt icon--left">drag_handle</i>
                                            <a class="flex"
                                               href="student-lesson.html">Template Syntax</a>
                                            <span class="text-muted">04:23</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
            
                            <a href="#"
                               class="btn btn-outline-secondary mb-24pt mb-sm-0">Add Section</a>
            
                        </div>
                        <div class="col-md-4">
            
                            <div class="card">
                                <div class="card-header text-center">
                                    <a href="#"
                                       class="btn btn-accent" >Save changes</a>
                                </div>
                                <div class="list-group list-group-flush">
                                    <div class="list-group-item d-flex">
                                        <a class="flex"
                                           href="#"><strong>Save Draft</strong></a>
                                        <i class="material-icons text-muted">check</i>
                                    </div>
                                    <div class="list-group-item">
                                        <a href="#"
                                           class="text-danger"><strong>Delete Course</strong></a>
                                    </div>
                                </div>
                            </div>
            
                            <div class="page-separator">
                                <div class="page-separator__text">Video</div>
                            </div>
            
                            <div class="card">
                                <div class="embed-responsive embed-responsive-16by9">
                                    <iframe class="embed-responsive-item"
                                            src="https://player.vimeo.com/video/97243285?title=0&amp;byline=0&amp;portrait=0"
                                            allowfullscreen=""></iframe>
                                </div>
                                <div class="card-body">
                                    <label class="form-label">URL</label>
                                    <input type="text"
                                           class="form-control"
                                           value="https://player.vimeo.com/video/97243285?title=0&amp;byline=0&amp;portrait=0"
                                           placeholder="Enter Video URL">
                                    <small class="form-text text-muted">Enter a valid video URL.</small>
                                </div>
                            </div>
            
                            <div class="page-separator">
                                <div class="page-separator__text">Options</div>
                            </div>
            
                            <div class="card">
                                <div class="card-body">
                                    <div class="form-group">
                                        <label class="form-label">portal</label>
                                        <select name="portal" id="portal"
                                                class="form-control custom-select">
                                                
                                            
                                            
                                        </select>
                                        <small class="form-text text-muted">Select a category.</small>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Price</label>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="input-group form-inline">
                                                    <span class="input-group-prepend"><span class="input-group-text">$</span></span>
                                                    <input type="text"
                                                           class="form-control"
                                                           value="24"
                                                           id="course-price">
                                                </div>
                                            </div>
                                        </div>
                                        <small class="form-text text-muted">The recommended price is between &dollar;17 and &dollar;24</small>
                                    </div>
                                    <div class="form-group mb-0">
                                        <label class="form-label"
                                               for="select03">Tags</label>
                                        <select id="select03"
                                                data-toggle="select"
                                                multiple
                                                class="form-control">
                                        </select>
                                        <small class="form-text text-muted">Select one or more tags.</small>
                                    </div>
                                </div>
                            </div>
            
                        </div>
                    </div>
            
                </div>
            </div>
        <!-- // END drawer-layout__content -->

        <!-- Drawer -->
        <div class="mdk-drawer js-mdk-drawer" id="default-drawer">
            <div class="mdk-drawer__content">
                <div class="sidebar sidebar-black-dodger-blue sidebar-left" data-perfect-scrollbar>
                    <div id="mySidebar"></div>
                    <!-- Sidebar Content -->
                </div>
            </div>
            <!-- // END Drawer -->
        </div>
    </div>
    <!-- // END Drawer Layout -->

    <!-- Header -->
    <script src="components/header.js"></script>

    <!-- Footer -->
    <script src="components/footer.js"></script>

    <!-- sidebar -->
    <script src="components/sidebar.js"></script>

    <!-- jQuery -->
    <script src="public/vendor/jquery.min.js"></script>

    <!-- Bootstrap -->
    <script src="myJS/bootstrap.bundle.min.js"></script>
    <script src="public/vendor/popper.min.js"></script>
    <script src="public/vendor/bootstrap.min.js"></script>

    <!-- Perfect Scrollbar -->
    <script src="public/vendor/perfect-scrollbar.min.js"></script>

    <!-- DOM Factory -->
    <script src="public/vendor/dom-factory.js"></script>

    <!-- MDK -->
    <script src="public/vendor/material-design-kit.js"></script>

    <!-- App JS -->
    <script src="public/js/app.js"></script>

    <!-- Preloader -->
    <script src="public/js/preloader.js"></script>

    <!-- added scripts not included in template -->
    <!-- Datatable js-->
    <script src="myJS/datatables/jquery.dataTables.min.js"></script>
    <script src="myJS/datatables/custom-basic.js"></script>
    <script src="myJS/QueryStringDivider.js"></script>

    <!-- Add this script after the jQuery script -->
<script>
    $(document).ready(function() {
        var CourseId; // Define CourseId at the top
    // Function to get URL parameters by name
    function getUrlParameter(name) {
        name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
        var regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
        var results = regex.exec(location.search);
        return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
    }
 // Check if status is 'update'
 var status = getUrlParameter('status');
    if (status === 'update') {
        // Function to display course information
        function display() {
            // Get TrainerId from URL
            var TrainerId = getUrlParameter('TrainerId');
console.log("trainerId",TrainerId)
            // AJAX request to get course information
            $.ajax({
                url: 'api/vwCourses.php',
                method: 'GET',
                data: {
                    status: 'coursesByTRainer',
                    TrainerId: TrainerId
                },
                dataType: 'json',
                success: function(response) {
    console.log('Response:', response); // Log the entire response object
    // Check if the expected properties exist in the response
    if (response && response.length > 0) {
                            var course = response[0];
                            if (course.CourseDesc && course.CourseName && course.Price && course.CourseId) {
                                // Access the course description, name, and price
                                var courseDesc = course.CourseDesc;
                                var courseName = course.CourseName;
                                var price = course.Price;
                             CourseId = course.CourseId;
        // Log or use the retrieved values as needed
        console.log('Course Description:', courseDesc);
        console.log('Course Name:', courseName);
        console.log('Price:', price);
        console.log("CourseId:",CourseId);
                   // Display the data in the form
                   $('.form-control-lg').val(courseName);
                                $('#course\\ Description').val(courseDesc);
                                $('#course-price').val(price);
                            } else {
                                console.error('Invalid course data:', course);
                            }
    } else {
        console.error('Invalid response format:', response);
    }
},
                error: function(xhr, status, error) {
                    console.error('Error:', error);
                }
            });
        }

        // Call the display function
        display();
    }



    // Attach event listener to "Save changes" button
    $('.btn.btn-accent').on('click', function(e) {
        e.preventDefault(); // Prevent default form submission

        // Check if status is 'new' or 'update'
        if (status === 'new') {
            // Function to save the new course
            saveNewCourse();
        } else {
            // Function to update the course
            updateCourse();
        }
    });

    // Function to save new course
    function saveNewCourse() {
        // AJAX request to save the new course
        $.ajax({
            url: 'api/vwCourses.php',
            method: 'GET',
            data: {
                status: 'new',
                TrainerId: TrainerId,
                CourseName: courseName,
                CourseDesc: courseDesc,
                Price: Price
            },
            dataType: 'json',
            success: function(response) {
                console.log(response); // Log server response
                alert('New course added successfully'); // Show success message
            },
            error: function(xhr, status, error) {
                console.error('Error adding new course:', error); // Log error message
                alert('Error adding new course. Please try again.'); // Show error message
            }
        });
    }

    // Function to update the course
    function updateCourse() {
        // Get updated course information from the form
        var updatedCourse = {
            CourseId: CourseId,
            CourseName: $('.form-control-lg').val(),
            CourseDesc: $('#course\\ Description').val(),
            Price: $('#course-price').val()
        };

        // AJAX request to update course information
        $.ajax({
            url: 'api/vwCourses.php',
            method: 'GET',
            data: {
                status: 'update',
                CourseId: updatedCourse.CourseId,
                CourseName: updatedCourse.CourseName,
                CourseDesc: updatedCourse.CourseDesc,
                Price: updatedCourse.Price
            },
            dataType: 'json',
            success: function(response) {
                console.log(response); // Log server response
                alert('Course updated successfully'); // Show success message
            },
            error: function(xhr, status, error) {
                console.error('Error updating course:', error); // Log error message
                alert('Error updating course. Please try again.'); // Show error message
            }
        });
    }
});
</script>

</body>

</html>






